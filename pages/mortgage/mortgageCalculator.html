<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>房贷计算器</title>
    <style>
        :root {
            --primary-color: #4CAF50;
            --secondary-color: #2196F3;
            --background-color: #f5f5f5;
            --card-background: #ffffff;
            --text-color: #333333;
            --border-color: #e0e0e0;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --font-size-small: 14px;
            --font-size-normal: 16px;
            --font-size-large: 18px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 10px;
            max-width: 100vw;
            overflow-x: hidden;
            padding-bottom: 60px;
        }

        .container {
            padding: 10px;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header h1 {
            color: var(--primary-color);
            font-size: var(--font-size-large);
            margin-bottom: 10px;
        }

        .header p {
            font-size: var(--font-size-small);
        }

        .calculator-container {
            display: block;
        }

        .input-card, .result-card {
            background: var(--card-background);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 10px var(--shadow-color);
            margin-bottom: 20px;
        }

        .loan-type-selector {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 5px;
            margin-bottom: 20px;
        }

        .loan-type-button {
            flex: 1;
            padding: 8px 5px;
            border: none;
            border-radius: 5px;
            background: var(--background-color);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: var(--font-size-small);
        }

        .loan-type-button.active {
            background: var(--primary-color);
            color: white;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-color);
            font-weight: 500;
        }

        .input-field {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: var(--font-size-normal);
            height: 44px;
        }

        /* 移除输入框的上下微调按钮 */
        .input-field::-webkit-outer-spin-button,
        .input-field::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .input-field[type=number] {
            -moz-appearance: textfield;
        }

        .input-addon {
            position: relative;
        }

        .input-addon:after {
            content: attr(data-unit);
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        .calculate-button {
            width: 100%;
            padding: 12px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s ease;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            margin: 0;
            padding: 15px;
            border-radius: 0;
            z-index: 1000;
        }

        .calculate-button:hover {
            background: #45a049;
        }

        .result-summary {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 30px;
        }

        .result-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .result-label {
            font-size: var(--font-size-small);
            color: #666;
        }

        .result-value {
            font-size: var(--font-size-normal);
            font-weight: bold;
            color: var(--primary-color);
            margin-top: 5px;
        }

        .repayment-schedule {
            margin-top: 30px;
        }

        .table-container {
            overflow-x: auto;
            margin: 0 -15px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: var(--font-size-small);
        }

        th, td {
            padding: 8px;
            text-align: right;
            border-bottom: 1px solid var(--border-color);
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            text-align: center;
        }

        tr:hover {
            background: #f5f5f5;
        }

        .chart-container {
            margin-top: 30px;
            height: 250px;
            margin: 15px -15px 0;
        }

        .tab-container {
            margin-top: 20px;
        }

        .tab-buttons {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
        }

        .tab-button {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            background: var(--background-color);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: var(--font-size-small);
        }

        .tab-button.active {
            background: var(--primary-color);
            color: white;
        }

        @media (max-width: 768px) {
            .calculator-container {
                grid-template-columns: 1fr;
            }

            .result-summary {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        /* Toast提示样式 */
        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 24px;
            border-radius: 8px;
            color: white;
            font-size: 14px;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            animation: toastSlideUp 0.3s ease-out;
            max-width: 90%;
            text-align: center;
        }
        
        .toast.success {
            background-color: var(--primary-color);
        }
        
        .toast.error {
            background-color: #ef4444;
        }
        
        .toast.warning {
            background-color: #f59e0b;
        }
        
        .toast.info {
            background-color: var(--secondary-color);
        }
        
        @keyframes toastSlideUp {
            from {
                opacity: 0;
                transform: translateX(-50%) translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div style="text-align: left; margin-bottom: 10px;">
                <a href="../../index.html" style="color: var(--primary-color); text-decoration: none; font-size: 14px; display: inline-flex; align-items: center;">
                    ← 返回主页
                </a>
            </div>
            <h1>房贷计算器</h1>
            <p>支持商业贷款、公积金贷款和组合贷款计算</p>
        </div>

        <div class="calculator-container">
            <div class="input-card">
                <div class="loan-type-selector">
                    <button class="loan-type-button active" onclick="switchLoanType('commercial', event)">商业贷款</button>
                    <button class="loan-type-button" onclick="switchLoanType('fund', event)">公积金贷款</button>
                    <button class="loan-type-button" onclick="switchLoanType('combined', event)">组合贷款</button>
                </div>

                <!-- 商业贷款输入 -->
                <div id="commercial-inputs">
                    <div class="input-group">
                        <label>贷款总额</label>
                        <div class="input-addon" data-unit="万元">
                            <input type="number" id="commercialAmount" class="input-field" placeholder="请输入贷款金额">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>贷款年限</label>
                        <div class="input-addon" data-unit="年">
                            <input type="number" id="commercialYears" class="input-field" placeholder="请输入贷款年限">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>年利率</label>
                        <div class="input-addon" data-unit="%">
                            <input type="number" id="commercialRate" class="input-field" placeholder="请输入年利率">
                        </div>
                    </div>
                </div>

                <!-- 公积金贷款输入 -->
                <div id="fund-inputs" style="display: none;">
                    <div class="input-group">
                        <label>贷款总额</label>
                        <div class="input-addon" data-unit="万元">
                            <input type="number" id="fundAmount" class="input-field" placeholder="请输入贷款金额">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>贷款年限</label>
                        <div class="input-addon" data-unit="年">
                            <input type="number" id="fundYears" class="input-field" placeholder="请输入贷款年限">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>年利率</label>
                        <div class="input-addon" data-unit="%">
                            <input type="number" id="fundRate" class="input-field" placeholder="请输入年利率">
                        </div>
                    </div>
                </div>

                <!-- 组合贷款输入 -->
                <div id="combined-inputs" style="display: none;">
                    <div class="input-group">
                        <label>商业贷款金额</label>
                        <div class="input-addon" data-unit="万元">
                            <input type="number" id="combinedCommercialAmount" class="input-field" placeholder="请输入商业贷款金额">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>商业贷款年利率</label>
                        <div class="input-addon" data-unit="%">
                            <input type="number" id="combinedCommercialRate" class="input-field" placeholder="请输入商业贷款年利率">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>公积金贷款金额</label>
                        <div class="input-addon" data-unit="万元">
                            <input type="number" id="combinedFundAmount" class="input-field" placeholder="请输入公积金贷款金额">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>公积金贷款年利率</label>
                        <div class="input-addon" data-unit="%">
                            <input type="number" id="combinedFundRate" class="input-field" placeholder="请输入公积金贷款年利率">
                        </div>
                    </div>
                    <div class="input-group">
                        <label>贷款年限</label>
                        <div class="input-addon" data-unit="年">
                            <input type="number" id="combinedYears" class="input-field" placeholder="请输入贷款年限">
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label>还款方式</label>
                    <select id="repaymentMethod" class="input-field">
                        <option value="equal">等额本息</option>
                        <option value="principal">等额本金</option>
                    </select>
                </div>

                <button class="calculate-button" onclick="calculateMortgage()">计算还款明细</button>
            </div>

            <div class="result-card">
                <div class="result-summary">
                    <div class="result-item">
                        <div class="result-label">贷款总额</div>
                        <div class="result-value" id="totalLoan">0万元</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">总利息</div>
                        <div class="result-value" id="totalInterest">0万元</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">还款总额</div>
                        <div class="result-value" id="totalPayment">0万元</div>
                    </div>
                    <div class="result-item">
                        <div class="result-label">首月还款</div>
                        <div class="result-value" id="firstPayment">0元</div>
                    </div>
                </div>

                <div class="tab-container">
                    <div class="tab-buttons">
                        <button class="tab-button active" onclick="switchTab('schedule', event)">还款计划</button>
                        <button class="tab-button" onclick="switchTab('chart', event)">还款分析</button>
                    </div>

                    <div id="schedule-tab">
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>期数</th>
                                        <th>月供</th>
                                        <th>本金</th>
                                        <th>利息</th>
                                        <th>剩余本金</th>
                                    </tr>
                                </thead>
                                <tbody id="repaymentSchedule">
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div id="chart-tab" style="display: none;">
                        <div class="chart-container" id="paymentChart"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script>
        let currentLoanType = 'commercial';
        let chart = null;
        
        // Toast提示函数
        function showToast(message, type = 'info') {
            // 移除已存在的toast
            const existingToast = document.querySelector('.toast');
            if (existingToast) {
                existingToast.remove();
            }
            
            // 创建新的toast
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            // 3秒后自动移除
            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(-50%) translateY(20px)';
                setTimeout(() => {
                    if (toast.parentNode) {
                        toast.parentNode.removeChild(toast);
                    }
                }, 300);
            }, 3000);
        }
        
        // 统一函数名，供按钮调用
        function calculateMortgage() {
            calculate();
        }

        // 切换贷款类型
        function switchLoanType(type, event) {
            currentLoanType = type;
            document.querySelectorAll('.loan-type-button').forEach(btn => {
                btn.classList.remove('active');
            });
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                // 如果没有event，通过type找到对应按钮
                document.querySelectorAll('.loan-type-button').forEach(btn => {
                    if (btn.getAttribute('onclick') && btn.getAttribute('onclick').includes(type)) {
                        btn.classList.add('active');
                    }
                });
            }

            // 隐藏所有输入区域
            document.querySelectorAll('#commercial-inputs, #fund-inputs, #combined-inputs').forEach(div => {
                div.style.display = 'none';
            });

            // 显示选中的输入区域
            document.getElementById(type + '-inputs').style.display = 'block';
        }

        // 切换标签页
        function switchTab(tab, event) {
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            if (event && event.target) {
                event.target.classList.add('active');
            } else {
                // 如果没有event，通过tab找到对应按钮
                document.querySelectorAll('.tab-button').forEach(btn => {
                    if (btn.getAttribute('onclick') && btn.getAttribute('onclick').includes(tab)) {
                        btn.classList.add('active');
                    }
                });
            }

            document.getElementById('schedule-tab').style.display = tab === 'schedule' ? 'block' : 'none';
            document.getElementById('chart-tab').style.display = tab === 'chart' ? 'block' : 'none';

            if (tab === 'chart' && chart) {
                chart.resize();
            }
        }

        // 格式化金额
        function formatMoney(amount, decimals = 2) {
            return amount.toFixed(decimals).replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // 修正月利率转换函数
        function calculateMonthlyRate(yearRate) {
            // 修正为正确的复利转换公式，而不是简单的除以12
            return Math.pow(1 + yearRate / 100, 1/12) - 1;
        }

        // 修改计算函数
        function calculate() {
            // 修复：从select元素获取还款方式
            const repaymentMethodSelect = document.getElementById('repaymentMethod');
            const paymentMethod = repaymentMethodSelect ? repaymentMethodSelect.value : 'equal';
            let loanType = currentLoanType;
            
            // 验证输入
            let isValid = true;
            let errorMessage = '';
            
            if (loanType === 'commercial') {
                const amount = parseFloat(document.getElementById('commercialAmount').value) || 0;
                const years = parseInt(document.getElementById('commercialYears').value) || 0;
                const rate = parseFloat(document.getElementById('commercialRate').value) || 0;
                if (amount <= 0 || years <= 0 || rate <= 0) {
                    isValid = false;
                    errorMessage = '请输入有效的贷款金额、年限和利率';
                }
            } else if (loanType === 'fund') {
                const amount = parseFloat(document.getElementById('fundAmount').value) || 0;
                const years = parseInt(document.getElementById('fundYears').value) || 0;
                const rate = parseFloat(document.getElementById('fundRate').value) || 0;
                if (amount <= 0 || years <= 0 || rate <= 0) {
                    isValid = false;
                    errorMessage = '请输入有效的贷款金额、年限和利率';
                }
            } else if (loanType === 'combined') {
                const commercialAmount = parseFloat(document.getElementById('combinedCommercialAmount').value) || 0;
                const fundAmount = parseFloat(document.getElementById('combinedFundAmount').value) || 0;
                const years = parseInt(document.getElementById('combinedYears').value) || 0;
                const commercialRate = parseFloat(document.getElementById('combinedCommercialRate').value) || 0;
                const fundRate = parseFloat(document.getElementById('combinedFundRate').value) || 0;
                if ((commercialAmount <= 0 && fundAmount <= 0) || years <= 0 || commercialRate <= 0 || fundRate <= 0) {
                    isValid = false;
                    errorMessage = '请输入有效的贷款金额、年限和利率';
                }
            }
            
            if (!isValid) {
                showToast(errorMessage, 'error');
                return;
            }
            
            // 显示结果区域
            const resultCard = document.querySelector('.result-card');
            if (resultCard) {
                resultCard.style.display = 'block';
            }
            
            // 根据贷款类型获取输入参数
            let loanAmount = 0;
            let years = 0;
            let commercialRate = 0;
            let fundRate = 0;
            let commercialAmount = 0;
            let fundAmount = 0;
            
            if (loanType === 'commercial') {
                commercialAmount = parseFloat(document.getElementById('commercialAmount').value) * 10000 || 0;
                years = parseInt(document.getElementById('commercialYears').value) || 30;
                commercialRate = parseFloat(document.getElementById('commercialRate').value) || 4.9;
                loanAmount = commercialAmount;
            } else if (loanType === 'fund') {
                fundAmount = parseFloat(document.getElementById('fundAmount').value) * 10000 || 0;
                years = parseInt(document.getElementById('fundYears').value) || 30;
                fundRate = parseFloat(document.getElementById('fundRate').value) || 3.25;
                loanAmount = fundAmount;
            } else if (loanType === 'combined') {
                commercialAmount = parseFloat(document.getElementById('combinedCommercialAmount').value) * 10000 || 0;
                fundAmount = parseFloat(document.getElementById('combinedFundAmount').value) * 10000 || 0;
                years = parseInt(document.getElementById('combinedYears').value) || 30;
                commercialRate = parseFloat(document.getElementById('combinedCommercialRate').value) || 4.9;
                fundRate = parseFloat(document.getElementById('combinedFundRate').value) || 3.25;
                loanAmount = commercialAmount + fundAmount;
            }
            
            // 注意：displayLoanType 和 displayPaymentMethod 元素不存在，已移除相关代码
            // 还款方式信息已通过select元素显示，无需额外显示
            
            // 计算月供和还款总额
            let schedule = [];
            let totalInterest = 0;
            let totalPayment = 0;
            let monthlyPayment = 0;
            const months = years * 12;
            
            if (loanType === 'combined') {
                // 分开计算商业贷款和公积金贷款
                const commercialMonthlyRate = calculateMonthlyRate(commercialRate);
                const fundMonthlyRate = calculateMonthlyRate(fundRate);
                
                let commercialSchedule = calculateSchedule(commercialAmount, commercialMonthlyRate, months, paymentMethod);
                let fundSchedule = calculateSchedule(fundAmount, fundMonthlyRate, months, paymentMethod);
                
                // 合并两种贷款的还款计划
                for (let i = 0; i < months; i++) {
                    const commercial = commercialSchedule[i];
                    const fund = fundSchedule[i];
                    
                    schedule.push({
                        month: i + 1,
                        payment: commercial.payment + fund.payment,
                        principal: commercial.principal + fund.principal,
                        interest: commercial.interest + fund.interest,
                        remaining: commercial.remaining + fund.remaining
                    });
                    
                    totalInterest += commercial.interest + fund.interest;
                    totalPayment += commercial.payment + fund.payment;
                    
                    if (i === 0) {
                        monthlyPayment = commercial.payment + fund.payment;
                    }
                }
            } else {
                // 单一类型贷款计算
                const rate = loanType === 'commercial' ? commercialRate : fundRate;
                const monthlyRate = calculateMonthlyRate(rate);
                
                schedule = calculateSchedule(loanAmount, monthlyRate, months, paymentMethod);
                totalInterest = schedule.reduce((sum, item) => sum + item.interest, 0);
                totalPayment = schedule.reduce((sum, item) => sum + item.payment, 0);
                monthlyPayment = schedule[0].payment;
            }
            
            // 更新结果摘要
            document.getElementById('totalLoan').textContent = formatMoney(loanAmount / 10000) + '万元';
            document.getElementById('totalInterest').textContent = formatMoney(totalInterest / 10000) + '万元';
            document.getElementById('totalPayment').textContent = formatMoney(totalPayment / 10000) + '万元';
            document.getElementById('firstPayment').textContent = formatMoney(monthlyPayment) + '元';
            
            // 更新还款计划表格
            const tbody = document.getElementById('repaymentSchedule');
            tbody.innerHTML = '';
            
            // 为了减少渲染压力，只显示部分数据
            const displaySchedule = getDisplaySchedule(schedule);
            
            displaySchedule.forEach(item => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${item.month}</td>
                    <td>${formatMoney(item.payment)}</td>
                    <td>${formatMoney(item.principal)}</td>
                    <td>${formatMoney(item.interest)}</td>
                    <td>${formatMoney(Math.max(0, item.remaining))}</td>
                `;
            });
            
            // 更新图表
            updateChart(schedule);
        }
        
        // 提取计算还款计划的逻辑到单独的函数
        function calculateSchedule(loanAmount, monthlyRate, months, paymentMethod) {
            const schedule = [];
            let remainingPrincipal = loanAmount;
            let monthlyPayment = 0;
            
            if (paymentMethod === 'equal') {
                // 等额本息
                monthlyPayment = loanAmount * monthlyRate * Math.pow(1 + monthlyRate, months) / (Math.pow(1 + monthlyRate, months) - 1);
                
                for (let i = 1; i <= months; i++) {
                    const interest = remainingPrincipal * monthlyRate;
                    const principal = monthlyPayment - interest;
                    // 使用toFixed避免浮点数精度问题
                    remainingPrincipal = Math.max(0, parseFloat((remainingPrincipal - principal).toFixed(2)));
                    
                    schedule.push({
                        month: i,
                        payment: monthlyPayment,
                        principal: principal,
                        interest: interest,
                        remaining: remainingPrincipal
                    });
                }
            } else {
                // 等额本金
                const monthlyPrincipal = loanAmount / months;
                
                for (let i = 1; i <= months; i++) {
                    const interest = remainingPrincipal * monthlyRate;
                    const payment = monthlyPrincipal + interest;
                    // 使用toFixed避免浮点数精度问题
                    remainingPrincipal = Math.max(0, parseFloat((remainingPrincipal - monthlyPrincipal).toFixed(2)));
                    
                    schedule.push({
                        month: i,
                        payment: payment,
                        principal: monthlyPrincipal,
                        interest: interest,
                        remaining: remainingPrincipal
                    });
                    
                    if (i === 1) {
                        monthlyPayment = payment;
                    }
                }
            }
            
            return schedule;
        }
        
        // 获取展示用的还款计划（减少数据量）
        function getDisplaySchedule(schedule) {
            const displaySchedule = [];
            const totalMonths = schedule.length;
            
            // 始终显示第一年的每月数据
            for (let i = 0; i < Math.min(12, totalMonths); i++) {
                displaySchedule.push(schedule[i]);
            }
            
            // 后续每年选择性显示
            if (totalMonths > 12) {
                // 每年的第一个月
                for (let i = 12; i < totalMonths; i += 12) {
                    displaySchedule.push(schedule[i]);
                }
                
                // 始终显示最后一期
                if (displaySchedule[displaySchedule.length - 1].month !== totalMonths) {
                    displaySchedule.push(schedule[totalMonths - 1]);
                }
            }
            
            return displaySchedule;
        }

        // 更新图表
        function updateChart(schedule) {
            const chartContainer = document.getElementById('paymentChart');
            if (!chart) {
                chart = echarts.init(chartContainer);
            }

            const months = schedule.map(item => item.month);
            const payments = schedule.map(item => item.payment);
            const principals = schedule.map(item => item.principal);
            const interests = schedule.map(item => item.interest);

            const option = {
                title: {
                    text: '还款构成分析',
                    left: 'center',
                    textStyle: {
                        fontSize: 14
                    }
                },
                legend: {
                    data: ['月供', '本金', '利息'],
                    top: 25,
                    textStyle: {
                        fontSize: 12
                    }
                },
                grid: {
                    left: '8%',
                    right: '4%',
                    bottom: '12%',
                    top: '20%',
                    containLabel: true
                },
                tooltip: {
                    trigger: 'axis',
                    confine: true, // 确保提示框在图表区域内
                    formatter: function(params) {
                        return params[0].axisValue + '期<br/>' +
                            params.map(item => {
                                return item.seriesName + ': ' + formatMoney(item.value) + '元';
                            }).join('<br/>');
                    }
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: months,
                    name: '期数'
                },
                yAxis: {
                    type: 'value',
                    name: '金额（元）'
                },
                series: [
                    {
                        name: '月供',
                        type: 'line',
                        data: payments
                    },
                    {
                        name: '本金',
                        type: 'line',
                        data: principals
                    },
                    {
                        name: '利息',
                        type: 'line',
                        data: interests
                    }
                ]
            };

            chart.setOption(option);
        }

        // 监听窗口大小变化，调整图表大小
        window.addEventListener('resize', function() {
            if (chart) {
                chart.resize();
            }
        });
    </script>
</body>
</html>
